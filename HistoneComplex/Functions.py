#!/usr/bin/env python
# coding: latin1
_name_="Functions"

import string
import operator
import sys
import os
import copy
import time
import pickle
import numpy as np
import itertools
import math
import random
import subprocess


# This module contains some of the functions that are repeatedly used. 
# As well as the Indel data and the short version copy information. 

# Data: 

def SigLoading(VarPATH):
  Signatures=[]
  f=open(VarPATH,'r')
  for line in f.readlines():
  	if line[-1]=='\n':
  		line=line[:len(line)-1]
  	line=line.replace('_','-')	
  	Signatures.append(line)		
  	for x in range(len(line)):
  		if line[x] not in ['a','t','c','g','-',' ']:
  			print "Es gibt nicht definierte Zeichen: {}".format(line[x])
  			sys.exit()

  siglength=len(Signatures[0])
  tiefe=len(Signatures)

  return Signatures,siglength,tiefe



def ReadInfo(InfoPATH):
  print InfoPATH

  f=open(InfoPATH,'r')

  KlassReads=[]
  IndexReads=[]

  for line in f.readlines():
  	liste=line.split()
  	# print liste
  	kiste=[]
  	for x in range(3,len(liste)):
  		kiste.append(liste[x][:2])
  	KlassReads.append(kiste)

  	iiste=[]	
  	for x in range(3,len(liste)):
  		iiste.append(int(liste[x][2:]))
  	IndexReads.append(iiste)
  f.close()

  return KlassReads,IndexReads

if 1:  

  # These are the three types of short histone seqs
  atacg= [55, 190, 280, 328, 420, 476, 835, 921, 935, 1017, 1091, 1097, 1125, 1153, 1160, 1287, 1294, 1325, 1372, 
  1422, 1514, 1566, 1672, 1810, 1826, 1858, 1935, 2082, 2174, 2305, 2392, 2693, 2914, 2921, 2991, 3015, 3289, 3723, 
  3835, 3901, 4054, 4079, 4096, 4379, 4474, 4487, 4614, 4618, 4677, 4743, 4875, 4878, 4937, 5119, 5171, 5239, 5324, 
  5340, 5443, 5547, 5598, 5605, 5663, 5703, 6242, 6267, 6275, 6339, 6448, 6562, 6612, 6617, 6623, 6689, 6768, 6790, 
  6880, 6893, 7102, 7262, 7461, 7513, 7554, 7803, 7817, 7871, 7924, 7940, 7958, 8000, 8035, 8055, 8094, 8353, 8418, 
  8526, 8617, 8902, 8932, 9022, 9293, 9359, 9365, 9548, 9664, 9826, 9841, 10027, 10096, 10100, 10167, 10186, 10624, 
  10668, 10878, 10992, 11102, 11168, 11178, 11264, 11364, 11470, 11516, 11624, 11627, 11719, 11733, 11884, 12090, 
  12332, 12601, 12615, 12653, 12801, 12869, 13175, 13196, 13339, 13379, 13398]

  tccta= [29, 30, 88, 90, 214, 215, 259, 340, 382, 406, 455, 466, 518, 523, 532, 563, 575, 633, 651, 652, 763, 
  817, 857, 882, 903, 943, 959, 960, 1088, 1123, 1126, 1127, 1215, 1240, 1283, 1284, 1292, 1312, 1369, 1370, 
  1394, 1399, 1406, 1446, 1480, 1481, 1512, 1520, 1591, 1611, 1612, 1614, 1615, 1640, 1641, 1671, 1675, 1676, 
  1678, 1808, 1818, 1819, 1820, 1876, 1879, 1926, 2000, 2001, 2003, 2004, 2080, 2142, 2172, 2363, 2378, 2381, 
  2406, 2646, 2741, 2852, 2862, 2863, 2865, 2919, 3013, 3019, 3046, 3047, 3049, 3054, 3080, 3111, 3112, 3125, 
  3126, 3148, 3172, 3179, 3263, 3272, 3279, 3296, 3342, 3343, 3351, 3401, 3466, 3470, 3518, 3519, 3599, 3626, 
  3638, 3689, 3738, 3812, 3813, 3815, 3849, 3889, 3949, 3983, 3984, 3989, 3990, 4009, 4069, 4078, 4094, 4115, 
  4116, 4119, 4137, 4166, 4167, 4203, 4204, 4232, 4337, 4383, 4421, 4422, 4440, 4441, 4544, 4580, 4605, 4608, 
  4642, 4709, 4710, 4712, 4756, 4775, 4776, 4844, 4845, 4850, 4994, 4995, 5076, 5077, 5096, 5097, 5112, 5286, 
  5290, 5301, 5335, 5349, 5458, 5540, 5541, 5603, 5677, 5700, 5733, 5781, 5782, 5814, 5816, 5846, 5847, 5893, 
  5914, 5946, 5947, 6066, 6067, 6070, 6224, 6226, 6256, 6257, 6271, 6273, 6306, 6314, 6315, 6367, 6465, 6558, 
  6643, 6657, 6658, 6677, 6678, 6799, 6804, 6842, 6907, 6908, 6922, 6959, 7144, 7175, 7202, 7212, 7292, 7328, 
  7329, 7351, 7352, 7437, 7438, 7456, 7579, 7580, 7591, 7621, 7666, 7667, 7760, 7761, 7775, 7776, 7787, 7788, 
  7790, 7799, 7800, 7839, 7840, 7897, 7899, 7938, 8092, 8107, 8142, 8185, 8262, 8317, 8318, 8336, 8483, 8524, 
  8540, 8542, 8543, 8634, 8679, 8782, 8891, 8892, 8893, 8963, 9013, 9020, 9114, 9159, 9245, 9265, 9338, 9339, 
  9376, 9377, 9380, 9444, 9445, 9532, 9554, 9556, 9765, 9820, 9831, 9924, 9989, 9991, 9992, 10057, 10058, 10066, 
  10090, 10094, 10138, 10165, 10215, 10240, 10241, 10335, 10362, 10363, 10372, 10373, 10375, 10376, 10521, 10522, 
  10524, 10594, 10663, 10745, 10914, 10989, 10996, 11114, 11138, 11181, 11182, 11236, 11238, 11298, 11302, 11317, 
  11329, 11361, 11455, 11659, 11660, 11664, 11697, 11860, 11882, 11948, 11986, 12029, 12032, 12064, 12172, 12240, 
  12243, 12250, 12252, 12316, 12330, 12408, 12412, 12417, 12418, 12461, 12534, 12535, 12546, 12600, 12626, 12683, 
  12686, 12755, 12807, 12911, 12936, 12946, 13082, 13087, 13091, 13095, 13096, 13143, 13144, 13297, 13298, 13308, 13337, 13395, 13403]

  tcctg= [54, 119, 393, 525, 531, 650, 765, 834, 902, 920, 1053, 1156, 1311, 1398, 1408, 1483, 1590, 1668, 1928, 
  1934, 1942, 1991, 2010, 2224, 2405, 2518, 2645, 2692, 2913, 2930, 3053, 3114, 3141, 3262, 3271, 3288, 3293, 3441, 
  3465, 3539, 3541, 3717, 3794, 3845, 3852, 3891, 3982, 4000, 4086, 4130, 4134, 4352, 4355, 4382, 4404, 4406, 4439, 
  4486, 4610, 4742, 4936, 4997, 5075, 5153, 5251, 5289, 5442, 5509, 5549, 5597, 5606, 5662, 5702, 5780, 5913, 6110, 
  6281, 6299, 6305, 6501, 6622, 6660, 6688, 6789, 6889, 6933, 6958, 7177, 7440, 7460, 7512, 7566, 7578, 7669, 7737, 
  7750, 7753, 7759, 7802, 7813, 7870, 7896, 7999, 8034, 8050, 8054, 8154, 8417, 8482, 8924, 8956, 9085, 9142, 9337, 
  9430, 9505, 9518, 9559, 9663, 9819, 9844, 9939, 10023, 10056, 10137, 10185, 10243, 10294, 10649, 10972, 11140, 
  11300, 11515, 11620, 11709, 11732, 11739, 11812, 11859, 11888, 12012, 12046, 12533, 12545, 12999, 13174, 13195, 13272, 13296, 13397]


  # These are the big InDels:
  InDels=[[2561, 11650, 9603, 2822, 6025, 6027, 396, 12557, 2702, 1937, 4627, 10006, 1944, 7069, 12065, 548, 3622, 
  8241, 1201, 13107, 2997, 8100, 4669, 3649, 1347, 6855, 5576, 12361, 589, 11981, 6865, 11602, 3796, 11350, 4516, 
  11227, 11612, 9851, 2148, 3601, 11004, 2673, 7035, 2044, 7549, 1022], [8193, 2566, 2970, 9746, 8723, 1046, 
  10415, 11610, 4126, 1062, 5161, 3634, 1077, 2614, 4667, 8764, 582, 583, 7755, 7756, 3664, 3665, 602, 10843,
   10844, 2665, 2666, 5229, 10862, 2671, 9747, 4213, 4214, 4736, 8835, 8836, 5258, 5259, 9870, 3217, 12227, 
   10901, 159, 169, 174, 175, 3761, 9922, 6853, 11979, 9932, 9933, 6862, 6863, 2773, 2265, 9946, 6373, 6374, 
   4330, 8939, 9467, 9468, 13054, 6400, 12035, 7943, 12554, 12555, 10003, 10004, 11993, 793, 794, 11038, 9008, 
   11043, 2345, 3371, 13104, 4918, 4412, 4413, 1854, 11585, 1078, 9030, 9031, 4953, 4954, 8763, 8552, 11118, 
   11069, 7025, 7026, 11667, 1917, 7038, 7039, 897, 13186, 13187, 6023, 2446, 8594, 8595, 8089, 9601, 5021, 
   5022, 6059, 6576, 6578, 438, 6595, 1989, 13262, 11214, 3547, 3548, 11770, 5087, 10209, 10210, 12774, 4689, 
   4584, 5613, 2042, 6139, 12797], [9217, 9218, 9220, 11440, 2060, 2061, 2062, 6159, 2065, 2066, 10774, 11097, 
   10213, 6172, 6173, 542, 9759, 9760, 8654, 13265, 10276, 2599, 6187, 556, 4141, 5166, 1071, 1072, 8754, 
   10981, 6708, 1590, 6711, 6712, 11833, 8031, 5898, 12351, 13266, 4192, 9418, 5565, 12175, 4680, 10827, 
   4175, 4176, 5748, 7765, 4281, 5721, 7259, 1628, 4794, 13267, 5989, 96, 4193, 4194, 4195, 5220, 9322, 9323, 
   8300, 3694, 1913, 4721, 626, 5747, 628, 5749, 4731, 448, 9859, 2180, 11911, 8239, 12430, 4240, 4241, 658, 
   5267, 9326, 4758, 4759, 9368, 8857, 8858, 10904, 5790, 5791, 9584, 10779, 676, 12486, 5745, 9899, 7538, 
   1710, 11439, 8880, 10611, 4638, 1209, 1210, 4795, 8394, 7361, 706, 12995, 12996, 12997, 3782, 12487, 3784, 
   8393, 5322, 9419, 13005, 8910, 8911, 720, 721, 13010, 1236, 5333, 3799, 3800, 1753, 1754, 11995, 11996, 
   11997, 4833, 10978, 1915, 7396, 7397, 5350, 3303, 3304, 1771, 2796, 9170, 2872, 7408, 7410, 7411, 4991, 
   2812, 12113, 6913, 6916, 10502, 6188, 5386, 5387, 9484, 2317, 11022, 4367, 4368, 4369, 8978, 8979, 12557, 
   12565, 12566, 13006, 11546, 3631, 11548, 10610, 12952, 4144, 7398, 10019, 10020, 13093, 12353, 5930, 6710, 
   10542, 10543, 10032, 12157, 9523, 7988, 2357, 7990, 2871, 824, 9524, 6971, 6972, 6973, 4926, 7989, 11411, 
   3907, 12354, 3397, 3398, 12273, 3400, 2893, 846, 5968, 2360, 3410, 3411, 3412, 12117, 12630, 3928, 10980, 
   4955, 13232, 6456, 8033, 2403, 4452, 4453, 12986, 9065, 874, 2412, 4242, 366, 368, 11752, 5490, 7539, 
   10612, 11125, 11126, 12777, 3961, 10866, 3451, 12156, 3453, 4990, 2431, 4992, 7041, 12629, 10305, 12953, 
   1772, 11791, 8855, 10306, 5571, 10127, 12176, 8674, 9620, 9369, 12185, 1434, 1435, 1436, 12016, 414, 6047, 
   2464, 2977, 9636, 12272, 1959, 1960, 2475, 12274, 13230, 13231, 11096, 11186, 12019, 9118, 1465, 13242, 
   850, 957, 4031, 4032, 7617, 5570, 4547, 9206, 11790, 7624, 7626, 10188, 462, 12280, 466, 12086, 9955, 
   10200, 12717, 4571, 3036, 9210, 12256, 6480, 7138, 8675, 8676, 8677, 6481, 8168, 11753, 11244, 4077, 
   11246, 4591, 4592, 11249, 10226, 10227, 2550, 9208, 4601, 4602, 4603, 12275], [1025, 1026, 4950, 8199, 
   11274, 11788, 5650, 10261, 10262, 2587, 3106, 8236, 7728, 7729, 6731, 12885, 3680, 4197, 11878, 11879, 
   9832, 4727, 4728, 12411, 8828, 1472, 10887, 10378, 12941, 678, 4783, 2234, 2235, 6365, 6366, 12512, 
   12513, 12011, 7919, 7936, 3544, 3864, 296, 9010, 3385, 9536, 2369, 12619, 2019, 6592, 9046, 4921, 5468, 
   4960, 8548, 1897, 1898, 3435, 9580, 8639, 6548, 13178, 3972, 3461, 321, 5007, 5008, 7058, 3988, 8611, 
   1970, 1971, 6591, 9664, 9665, 2635, 9156, 9157, 5062, 8137, 1994, 11723, 10702, 6096, 7640, 2524, 1506, 
   3555, 2027, 11251, 3578], [12032, 4738, 6833, 12710, 7177, 3851, 1932, 11553, 1678, 10477, 5136, 12946, 
   8083, 11028, 9110, 4633, 6296, 2244, 10138, 6043, 3997, 2206, 2464, 8353, 11682, 10531, 7845, 7718, 4903, 
   7447, 4009, 13082, 9159, 816, 817, 54, 8053, 9016, 5947, 11664, 10173, 6847, 1088, 8386, 1860, 709, 6983, 
   12872, 3852, 1611, 2637, 4558, 8656, 466, 3668, 8917, 12231, 1879, 9742, 11545, 733, 5335, 12892, 10640, 
   11963, 4068, 5861, 7526, 4328, 10604, 82, 9967, 3696, 8744, 10482, 2803, 12788, 3189, 12535, 12920, 12911, 
   7615, 6527], [12674, 2563, 11652, 8197, 6406, 915, 5526, 10391, 2075, 6019, 12061, 4767, 5659, 12451, 5158, 
   6825, 8263, 3884, 4399, 1203, 9141, 2999, 6968, 7610, 11839, 11072, 10435, 3653, 6726, 7521, 9928, 11847, 
   8269, 12494, 1873, 1234, 7251, 2006, 11481, 6362, 2012, 6213, 3678, 9823, 2273, 11729, 1386, 12397, 3953, 
   3575, 4988, 5098], [2050, 12292, 8534, 12294, 13, 8210, 8211, 8212, 11268, 8614, 36, 6181, 6182, 6183, 
   6184, 6185, 6193, 50, 2100, 6197, 4151, 10591, 60, 13322, 2111, 7179, 2117, 2118, 10313, 10315, 12365, 
   12366, 79, 8186, 12376, 2140, 8289, 12880, 6247, 4200, 4201, 2154, 107, 8301, 8302, 8187, 8304, 8312, 
   8313, 8314, 4225, 2182, 2183, 8331, 6284, 8334, 148, 6294, 2203, 2204, 12446, 160, 10401, 181, 182, 6857, 
   8564, 6330, 8379, 6332, 6858, 10439, 2249, 202, 2251, 6348, 6349, 6350, 2255, 2256, 6353, 12500, 222, 223, 
   4320, 2281, 6378, 13033, 4340, 248, 249, 2298, 2299, 2300, 254, 8447, 10681, 13359, 12572, 12573, 12574, 
   6436, 10580, 6194, 12593, 6450, 6451, 309, 4407, 4408, 8244, 4410, 4411, 8245, 9611, 6472, 9612, 2384, 
   2385, 4835, 8532, 8533, 342, 6490, 2397, 6495, 357, 358, 7569, 2408, 2409, 4460, 4461, 4462, 2415, 8563, 
   4468, 6517, 6518, 10985, 8572, 6530, 387, 12695, 6551, 12696, 5188, 10682, 425, 2479, 2480, 2481, 8626, 
   8631, 10680, 441, 442, 443, 444, 445, 10695, 457, 458, 459, 460, 11404, 10713, 10319, 4576, 4577, 4578, 
   6627, 10725, 10752, 513, 11352, 12813, 6673, 6674, 2579, 535, 536, 537, 2589, 2590, 10784, 10672, 2596, 
   8625, 555, 6701, 12846, 8757, 8759, 8760, 569, 570, 571, 572, 2621, 6718, 11701, 6720, 12865, 12866, 
   2629, 587, 6736, 6737, 10834, 10835, 6740, 6741, 4695, 2652, 2653, 2654, 2655, 12899, 613, 8810, 4199, 
   786, 9227, 10866, 6778, 6251, 8982, 646, 647, 4752, 4753, 12956, 12957, 6815, 2720, 12961, 2723, 2724, 
   2727, 683, 684, 8879, 6837, 6838, 6839, 2752, 6856, 4809, 4810, 10957, 2769, 6867, 13019, 13020, 10974,
    10975, 739, 4836, 4837, 4838, 10983, 8937, 10986, 10987, 13323, 2804, 2805, 2806, 9027, 11007, 13056, 
    4865, 6917, 2823, 13064, 6926, 6927, 2833, 2834, 4884, 4885, 4886, 4896, 4897, 8998, 8999, 4904, 13099, 
    13101, 13102, 11055, 4916, 6979, 11280, 8332, 1165, 9041, 10723, 852, 7311, 2911, 7312, 10258, 11281, 
    7013, 870, 7015, 7016, 13161, 13162, 1511, 889, 2938, 2939, 2946, 13328, 13191, 13192, 2953, 2954, 2955, 
    9100, 2961, 4463, 13214, 5023, 5024, 5025, 13329, 9126, 9127, 7082, 7083, 7084, 5039, 5040, 5044, 5045, 
    5046, 9143, 5048, 5050, 5051, 5052, 13245, 13246, 5058, 8761, 11425, 13257, 5068, 5069, 3025, 11353, 
    987, 988, 13277, 11230, 11231, 9189, 5094, 11241, 11242, 1003, 1004, 1008, 1009, 5108, 11253, 5110, 
    11255, 6996, 11261, 11262, 11435, 5124, 3077, 3078, 9226, 3083, 7180, 9232, 9233, 9234, 5146, 7196, 
    7197, 7198, 7207, 9257, 13358, 5167, 5168, 9268, 9278, 9279, 7236, 11342, 11343, 11344, 5203, 5204, 
    1109, 1110, 1111, 1112, 7257, 8378, 10812, 7014, 7356, 11375, 3184, 3185, 11631, 1144, 1145, 3197, 
    3198, 3199, 7302, 3207, 1164, 11405, 1166, 1167, 1168, 6680, 10777, 9373, 9374, 3233, 11426, 11427, 
    12145, 7338, 7339, 11436, 7343, 7344, 9393, 5298, 7355, 5308, 203, 10679, 10785, 1229, 1230, 5327, 5329, 
    5330, 10446, 11479, 10447, 9438, 7403, 7404, 5359, 12931, 11517, 5376, 5377, 5378, 11523, 12845, 9491, 
    3348, 11550, 9503, 5408, 11558, 11559, 11560, 7048, 1330, 3380, 5429, 5430, 7479, 11146, 9099, 7493, 
    11596, 11597, 3407, 1360, 1361, 1362, 7508, 11434, 12730, 5472, 10811, 11621, 5479, 2620, 7531, 11630, 
    6717, 1396, 5493, 5494, 5499, 12864, 6379, 7556, 7557, 5511, 1418, 1419, 1420, 1424, 1425, 7570, 3494, 
    11689, 7594, 11691, 7596, 7597, 11700, 3509, 10157, 13215, 11714, 1475, 3525, 3526, 5584, 1489, 1490, 
    1493, 1494, 9688, 5595, 9692, 9693, 8784, 3559, 3572, 2302, 10836, 10837, 5633, 3588, 3589, 3595, 3596, 
    3597, 5646, 5647, 3613, 3614, 5668, 5669, 9768, 9769, 7723, 9775, 3643, 11853, 11854, 11855, 11856, 
    11863, 11864, 11866, 1635, 1636, 10172, 9838, 9839, 3347, 7797, 3702, 1658, 7804, 7805, 11902, 11903, 
    7809, 7811, 9862, 1672, 7822, 11919, 11920, 11921, 11922, 8785, 5785, 5786, 5787, 5799, 5800, 3756, 
    9504, 1731, 1732, 11969, 5832, 11984, 1745, 7891, 7892, 7893, 7894, 7895, 5857, 7911, 3822, 5875, 
    9973, 12024, 12025, 12041, 12043, 1806, 3855, 3856, 7954, 7955, 7965, 7967, 13160, 13275, 13276, 2354, 
    5936, 5937, 2355, 12088, 1851, 3381, 1857, 5954, 5955, 5956, 12105, 8010, 9527, 5971, 5972, 5973, 4409, 
    5979, 1884, 1885, 1886, 10084, 12142, 12143, 12144, 12264, 3956, 3957, 3958, 3959, 12161, 12162, 8072, 
    8073, 8074, 6751, 8080, 12183, 12186, 12188, 1951, 1952, 8097, 10225, 10155, 4012, 4013, 10158, 4015, 
    4021, 8122, 8123, 8124, 12960, 11254, 8136, 8137, 12279, 6096, 4049, 4050, 7503, 8156, 8157, 8158, 12255, 
    8160, 7504, 8162, 8163, 8164, 2023, 2024, 2025, 10224, 1704, 8531, 12278, 6135, 4089, 4090, 4091, 8188, 
    10581], [0, 7168, 8194, 4099, 4100, 4101, 7169, 4104, 4105, 10, 8206, 10180, 10256, 12305, 12306, 10243, 
    10260, 4117, 6170, 12315, 10268, 4125, 4126, 6179, 2084, 39, 8234, 8235, 2093, 10286, 8541, 12344, 10297, 
    9567, 11527, 68, 8261, 12358, 71, 72, 2121, 12362, 75, 77, 2126, 10322, 10323, 84, 85, 89, 12619, 6235, 
    10334, 12645, 4193, 10338, 8294, 10345, 10346, 113, 4210, 13370, 2164, 4213, 4214, 6263, 121, 12410, 12411, 
    10261, 6272, 10370, 9579, 10374, 10378, 6284, 2192, 6289, 2196, 2197, 151, 4248, 8345, 6300, 158, 6853, 9243, 
    4260, 167, 168, 4267, 174, 175, 4272, 12465, 8370, 8373, 8374, 10423, 2232, 2233, 2235, 4287, 4288, 4291, 
    8388, 8389, 6342, 8392, 11758, 12490, 205, 206, 9933, 213, 9155, 2265, 6365, 4318, 9253, 12512, 4321, 
    13163, 3110, 6374, 6376, 4329, 4330, 239, 2291, 4341, 10493, 6399, 1408, 2307, 4357, 4358, 10506, 10967, 
    10626, 6415, 6416, 12561, 6418, 275, 6423, 3460, 10287, 9946, 2335, 2336, 289, 4388, 4389, 295, 2344, 
    4393, 2346, 4395, 4396, 8502, 8503, 315, 4412, 4413, 318, 319, 320, 10561, 10571, 6476, 6882, 12622, 8529, 
    4441, 4442, 12687, 5178, 12638, 12639, 12100, 8549, 8551, 6505, 2413, 10607, 12658, 8595, 12661, 8566, 376, 
    12665, 12666, 2429, 8578, 10628, 7233, 6538, 6539, 8591, 8594, 2451, 10556, 9966, 4164, 10650, 5742, 4511, 
    4512, 8609, 8610, 12707, 6567, 6568, 3484, 12562, 9700, 6573, 6575, 6577, 6578, 2485, 438, 439, 4536, 4537,
     4538, 10686, 4543, 6594, 6595, 8192, 12741, 8648, 4557, 10702, 2125, 4560, 12756, 12757, 12758, 11336, 
     11610, 12359, 6625, 12223, 12774, 10109, 4584, 8685, 8686, 495, 10736, 12712, 10744, 507, 508, 2557, 510, 
     8703, 8704, 516, 2566, 519, 4619, 2574, 2579, 12820, 10329, 6683, 6684, 6690, 7942, 9361, 6697, 8748, 8749,
      8750, 12853, 2614, 12858, 4667, 8764, 10862, 437, 576, 6723, 583, 2635, 440, 13045, 12885, 10838, 12887, 
      2648, 602, 10843, 10844, 605, 12227, 8799, 2656, 8803, 12900, 12901, 12902, 4711, 2665, 2666, 2670, 623, 
      6770, 8821, 4726, 10004, 6591, 8830, 4735, 4736, 6785, 4739, 8836, 10886, 12936, 4745, 6796, 12941, 10461, 
      8849, 8850, 6808, 6812, 8863, 673, 6818, 4771, 10916, 678, 680, 681, 12971, 6832, 2737, 12981, 699, 700, 
      701, 8894, 10943, 13185, 10945, 706, 6262, 711, 13001, 6862, 6863, 10961, 11043, 2772, 9678, 13014, 10361, 
      8921, 2780, 8929, 2786, 10415, 9340, 8939, 9777, 4854, 760, 9259, 8959, 13056, 8964, 4869, 6918, 8968, 
      6921, 13067, 13068, 13288, 6930, 792, 793, 794, 9007, 7528, 11042, 4899, 6952, 6369, 4908, 2861, 815, 
      9008, 13105, 9010, 4918, 4920, 11065, 7306, 4392, 7307, 9030, 9031, 11081, 11084, 846, 2896, 11064, 
      11090, 11091, 2900, 4950, 856, 4953, 9051, 860, 12773, 7009, 13155, 11108, 13158, 5265, 11115, 9781, 
      11118, 11069, 7025, 7026, 9075, 2932, 9077, 7030, 4983, 9080, 13177, 7037, 7038, 897, 898, 13187, 7050, 
      7052, 7053, 5006, 7661, 912, 7057, 7058, 13123, 7662, 10052, 2970, 2971, 7072, 5026, 932, 933, 12444, 
      12511, 11183, 11187, 4254, 7094, 9145, 3002, 11195, 8488, 7104, 961, 3011, 3012, 7109, 5062, 13255, 
      11213, 13262, 9170, 9379, 980, 7534, 11769, 12035, 5086, 5087, 13280, 3041, 3042, 3579, 11237, 3048, 
      12796, 12797, 12118, 8360, 9990, 3923, 11092, 1019, 13309, 1024, 1025, 1026, 7171, 1028, 4944, 5127, 
      11272, 5132, 3085, 8763, 7184, 9254, 9235, 12462, 1046, 9241, 8367, 3104, 3105, 1061, 1062, 11305, 6663,
       12466, 9264, 11784, 7218, 1076, 1077, 1078, 7223, 3130, 3131, 7228, 9738, 7232, 5185, 3138, 11335, 
       7240, 11337, 7243, 13389, 1102, 5199, 5201, 13156, 1116, 11358, 5217, 1128, 5229, 7278, 1137, 1138, 
       5242, 1147, 1148, 2240, 11395, 1157, 9352, 5257, 5258, 5259, 7308, 3217, 3219, 7327, 3235, 5285, 
       9756, 7339, 8193, 1207, 3258, 5310, 9078, 9415, 3274, 11127, 9425, 9426, 11477, 10134, 9431, 7392, 
       1249, 1250, 1252, 3965, 7720, 7412, 8062, 9467, 1276, 1278, 6180, 11520, 1282, 9476, 12727, 9089, 
       7436, 3341, 11536, 1299, 5398, 1303, 5400, 7727, 1308, 5410, 7729, 3432, 3370, 3371, 11565, 3374, 
       5423, 10462, 11575, 3387, 3388, 9535, 9536, 7490, 9542, 5447, 3402, 9442, 1358, 9555, 11604, 3413, 
       7510, 7514, 5468, 3421, 6373, 9568, 9570, 1379, 12662, 3431, 1384, 7529, 3434, 3435, 1390, 11632, 
       3443, 3444, 8639, 6377, 7547, 11647, 3456, 9601, 1412, 3461, 3463, 5513, 11661, 3471, 11666, 11667, 
       1428, 3478, 3479, 3481, 3483, 1436, 7581, 11680, 5538, 11684, 2631, 7601, 3507, 9664, 7606, 3517, 
       2293, 1472, 1473, 6731, 1476, 1477, 3533, 7630, 3543, 3544, 3546, 3547, 3548, 1506, 1508, 1510, 
       4689, 7660, 5613, 5614, 7663, 7665, 12053, 11765, 3576, 3577, 3578, 1531, 1541, 10497, 3592, 5642, 
       9739, 1548, 11522, 5648, 5649, 9746, 9749, 7708, 7709, 1571, 7717, 1574, 1969, 1576, 7721, 1579, 
       5679, 7728, 5681, 3634, 1587, 3637, 9782, 5687, 3641, 12554, 13237, 8800, 11842, 3651, 1606, 1607, 
       13104, 7755, 7756, 1613, 3664, 5719, 3674, 11868, 7773, 7774, 1631, 9828, 9830, 5734, 9832, 9834, 
       9836, 7789, 1646, 11989, 8126, 5751, 9848, 9849, 11899, 9852, 5757, 9856, 7446, 5766, 5767, 5399, 
       5772, 1677, 9870, 5775, 12859, 3731, 1685, 9878, 9156, 10523, 11945, 9901, 9902, 3761, 5815, 7864, 
       11962, 7867, 9920, 9921, 9922, 7559, 5830, 13083, 11979, 7885, 1742, 13261, 1746, 1749, 11897, 5848, 
       11993, 7898, 7901, 3806, 11999, 3808, 8583, 3816, 5865, 8856, 7918, 5871, 7920, 296, 1781, 1782, 2345, 
       1787, 5884, 7935, 12928, 9986, 9987, 5894, 7943, 1812, 1813, 5911, 3864, 10015, 7969, 7814, 12071, 
       12860, 7979, 11878, 3887, 8040, 1844, 1845, 5942, 5943, 7992, 5945, 7135, 1853, 1854, 8004, 8005, 
       12599, 10210, 8015, 10064, 12113, 3922, 2019, 3924, 11792, 12123, 12124, 1896, 1897, 8043, 10088, 
       4414, 10308, 8060, 1917, 3966, 3967, 3968, 11584, 6023, 10120, 12176, 3985, 381, 8085, 8086, 11726, 
       8089, 4008, 6058, 6059, 10431, 8111, 4017, 9203, 12575, 1981, 1982, 8127, 1985, 1987, 1988, 8865, 
       1993, 6096, 8145, 2002, 6099, 6100, 8153, 4058, 12251, 11251, 2016, 10209, 2018, 4067, 10842, 11170, 
       12888, 10218, 2027, 4082, 12752, 6819, 8183, 2042, 4093], [6656, 13314, 6660, 9733, 2574, 7184, 6163, 
       4117, 13342, 7711, 13348, 8966, 3110, 8541, 563, 3637, 1590, 7223, 11322, 3647, 576, 8261, 6729, 3148, 
       1613, 7759, 11859, 2645, 9303, 89, 9819, 7774, 6501, 7641, 5734, 4711, 1639, 4716, 7789, 531, 1652, 
       2678, 9337, 8316, 5248, 129, 5251, 3717, 4231, 2156, 1674, 10349, 1682, 4755, 5913, 6313, 7838, 3231,
        6305, 977, 10523, 5285, 4892, 6316, 12462, 6832, 5815, 7864, 3262, 5828, 3271, 10953, 3278, 3794, 
        5845, 6358, 10361, 7898, 4315, 8924, 9439, 7904, 6882, 10471, 3816, 6889, 4843, 12524, 752, 4849, 
        12533, 760, 12028, 11477, 5888, 12545, 13060, 5894, 11527, 6921, 3852, 3341, 10511, 10001, 11907, 
        1303, 1817, 12058, 3887, 1308, 4382, 8482, 7977, 9002, 12075, 9518, 4911, 7475, 4404, 6281, 5951,
         8007, 10056, 3402, 10059, 6989, 9555, 2900, 4439, 6493, 11315, 2405, 5481, 11115, 8048, 6803, 1398, 
         11127, 2425, 381, 902, 3465, 11661, 3982, 3471, 3985, 5523, 917, 2966, 7575, 10137, 7578, 7581, 1440, 
         9129, 11180, 5549, 11183, 7601, 6580, 3941, 3003, 4540, 3517, 4543, 8642, 1991, 4553, 5111, 12536, 
         2002, 5075, 980, 984, 8153, 4062, 6625, 995, 2533, 3048, 2537, 1515, 3053, 13296, 9990, 11765, 4086, 
         5289, 12031, 13309], [6144, 4, 13313, 2061, 6158, 2065, 4115, 6168, 6172, 12636, 6186, 4140, 4141, 
         48, 4146, 12340, 12341, 10296, 4158, 10303, 10304, 12353, 12354, 2402, 6157, 4176, 4177, 4183, 95, 
         4194, 12388, 12389, 8298, 2155, 10353, 10354, 6163, 4457, 129, 2179, 2180, 6277, 364, 4234, 7191, 
         12430, 10384, 4241, 4243, 10388, 163, 2215, 2216, 10611, 4280, 12485, 12486, 12487, 8393, 13347, 
         10456, 10457, 4315, 8412, 2269, 2270, 12516, 10470, 10471, 12523, 12524, 10510, 8435, 10489, 10502, 
         8455, 8456, 8457, 4364, 4365, 4366, 10511, 8464, 2321, 6418, 8467, 10516, 4374, 8473, 10536, 11996, 
         10540, 10541, 11997, 304, 305, 2357, 2360, 8506, 4429, 12624, 6481, 6482, 12628, 12629, 12630, 6492, 
         6493, 4450, 4453, 4456, 6695, 4458, 2411, 2412, 2413, 367, 10610, 9619, 10302, 2425, 8570, 10622, 
         2431, 12352, 3819, 3820, 2448, 12697, 4506, 2459, 2460, 414, 12703, 2475, 2476, 12717, 6583, 6589, 
         447, 8642, 4552, 4553, 6604, 6605, 8654, 10705, 4562, 8659, 4570, 4571, 8672, 13314, 8675, 8676, 
         2533, 2537, 10734, 4591, 4592, 2546, 2548, 8693, 4598, 4599, 4600, 12804, 6913, 12838, 13059, 10774, 
         4635, 541, 542, 4640, 8738, 12837, 2598, 551, 556, 2606, 8753, 6710, 6711, 6712, 4191, 4680, 10826, 
         592, 11022, 4697, 6748, 6749, 617, 619, 4716, 625, 4722, 4723, 4724, 629, 2678, 8823, 2681, 6779, 
         6780, 643, 644, 4747, 3522, 657, 4758, 4759, 8856, 2715, 2716, 12058, 674, 675, 676, 12965, 2844, 
         6826, 10924, 6829, 10355, 4793, 4794, 4795, 11722, 10948, 12997, 10953, 10253, 717, 8910, 719, 
         13010, 12067, 4825, 10979, 10980, 13035, 2796, 10706, 752, 2811, 2812, 769, 6915, 13060, 10937, 
         8974, 8975, 8976, 6938, 4891, 796, 797, 798, 805, 9001, 9002, 4910, 4911, 2870, 824, 825, 6970, 
         4926, 12985, 6989, 13134, 13135, 13136, 849, 850, 13139, 13140, 11095, 826, 864, 865, 866, 9065, 
         874, 878, 879, 12509, 10387, 11124, 12777, 13180, 4990, 4991, 4992, 11144, 9103, 2966, 7065, 7066, 
         2976, 13230, 13231, 13232, 9138, 13235, 3003, 956, 3006, 3007, 13251, 13252, 10807, 9037, 13265, 
         13266, 7124, 983, 984, 12111, 3036, 7398, 7149, 7150, 11248, 9209, 5114, 9217, 9218, 9219, 9221, 
         5129, 5130, 3089, 3092, 5143, 7192, 12651, 3100, 13342, 5155, 13348, 11783, 1072, 11315, 5175, 
         11444, 11322, 1083, 1086, 11445, 13152, 13153, 3154, 9303, 3161, 7259, 1121, 5219, 5220, 5221, 3176, 
         9322, 9323, 9325, 9326, 9327, 5235, 5236, 5247, 5248, 11410, 11411, 9368, 5277, 3230, 3231, 7268, 
         10779, 1193, 4637, 11440, 11441, 7348, 4638, 1209, 1210, 9759, 7358, 7359, 7361, 9413, 5322, 1236, 
         9439, 11489, 9442, 3300, 3301, 3302, 9449, 9450, 2599, 7410, 894, 3319, 11512, 5332, 5373, 5374, 
         11529, 5387, 9484, 7442, 11546, 11547, 11548, 9501, 9508, 7464, 7465, 8413, 9520, 7475, 9524, 8414, 
         5432, 5433, 10806, 3398, 3399, 7499, 10808, 3410, 3411, 12174, 9529, 5350, 5481, 7537, 7538, 7539, 
         3450, 3453, 5503, 9608, 9609, 5522, 5523, 7575, 1434, 1435, 1440, 1443, 9636, 8027, 7618, 3507, 
         3511, 1465, 5564, 5565, 5566, 5568, 7617, 5570, 5571, 9668, 7626, 11723, 11724, 7641, 7644, 7645, 
         5601, 4892, 9704, 11754, 1515, 3565, 3567, 9713, 5618, 5619, 5627, 5628, 9733, 1543, 9736, 11790, 
         1557, 461, 7711, 9760, 5723, 1573, 1574, 3629, 3630, 3631, 11830, 11832, 3646, 3647, 9792, 2316, 
         2317, 11857, 7763, 3669, 5721, 5722, 1627, 955, 8466, 5744, 5748, 1655, 11906, 11907, 12566, 11911, 
         11912, 620, 1680, 7825, 9880, 9881, 5790, 5791, 1706, 1708, 1709, 5811, 5812, 5813, 1652, 5828, 
         3782, 3783, 3784, 12236, 3787, 5852, 5853, 7904, 9953, 9955, 9169, 1768, 1770, 1771, 1772, 12016, 
         12018, 5901, 3859, 10007, 10008, 8653, 11568, 12066, 10019, 10020, 5926, 5927, 5928, 10031, 10032, 
         7986, 7987, 10206, 12086, 10042, 10043, 12093, 5951, 3904, 3905, 12951, 5965, 1871, 12112, 12116, 
         3925, 3926, 3927, 3929, 3931, 5983, 8032, 1890, 3941, 8048, 6003, 6006, 3960, 1914, 12157, 10116, 
         12167, 12168, 12169, 3979, 10124, 6030, 12176, 10904, 11246, 12271, 6044, 6045, 6046, 10146, 1959, 
         1960, 12274, 12068, 8131, 6085, 6092, 4061, 4062, 12256, 4433, 8168, 4076, 12269, 6127, 6129, 10226, 
         10227, 12282, 12283, 12284, 9898]]

  # The manual Assembly:
  AlleGruppen=pickle.load(open("pickledAssemblyGruppen","rb"))
  AlleGruppen=AlleGruppen[:len(AlleGruppen)-1]

  # Here I clean up the assembly groups by eliminating duplicates
  kicken=0
  for t1 in range(len(AlleGruppen)):
    for t2 in range(t1+1,len(AlleGruppen)):
      cut=[k for k in AlleGruppen[t1] if k in AlleGruppen[t2]]

      kicken+=len(cut)
      for k in cut:
        AlleGruppen[t1].remove(k)
        AlleGruppen[t2].remove(k)

 
  # Adding the short versions to the InDels    
  InDels.append(atacg)
  InDels.append(tcctg)
  InDels.append(tccta)




###################################
# Functions

def KlassAct(Group):
  counter={'No':0,'Ku':0,'Li':0,'Re':0,'Ze':0,'NN':0,'AN':0,'DA':0,'Cr':0}
  for (x,y) in Group:
    counter[KlassReads[x][y]]+=1
  sortedcounter=sorted(counter.items(),key=operator.itemgetter(1))
  sortedcounter=sortedcounter[::-1] 
  return sortedcounter[0][0]

# def SigDiff(sig1,sig2):
#   return len([x for x in range(len(sig1)) if (sig1[x]!=sig2[x] and (sig1[x]!=' ' and sig2[x]!=' '))])

def SigDiff(sig1,sig2,mindiff):
  error=0
  for x in range(len(sig1)):
    if sig1[x]!=sig2[x]:
      if sig1[x]!=' ':
        if sig2[x]!=' ':
          error+=1
          if error>mindiff:
            return error
  return error          

def Passend(sig, kon):
  fit=len([x for x in range(len(sig)) if sig[x]==kon[x] and sig[x]!=' '])
  cov=len([x for x in range(len(sig)) if kon[x]!=' ' and sig[x]!=' '])
  if cov==0:
    return 0.0
  else:
    return float(int(float(fit)*10000/float(cov)))/100

def GroupSplitter(Group,MA):
  breite=len(MA[0])
  GrupKon=[[0,0,0,0,0] for x in range(breite)]
  size=len(Group)
  #print "Size of Group:",
  #print size
  for y in Group:
    for x in range(breite):
      if MA[y][x]=='a':
        GrupKon[x][0]+=1
      if MA[y][x]=='c':
        GrupKon[x][1]+=1
      if MA[y][x]=='g':
        GrupKon[x][2]+=1
      if MA[y][x]=='t':
        GrupKon[x][3]+=1
      if MA[y][x]=='-':
        GrupKon[x][4]+=1  

  Variations=[] 

  for x in range(breite):
    if sum(GrupKon[x][:5])>len(Group)/2:  # Mit GapColumns.
      count=0
      for y in range(4):  # oder 5 dann mit -
        if GrupKon[x][y]>min(size/5,15):      
          count+=1
      if count>1:
        Variations.append(x)
        #print x,
        #print GrupKon[x],        
  #print
  return Variations

base2index={'a':0,'c':1,'g':2,'t':3,'-':4,' ':5}

def SigKon(Cluster, Sigs):
  kon=''
  for v in range(len(Sigs[0])):
    counter=[0,0,0,0,0,0]
    for x in Cluster:
      counter[base2index[Sigs[x][v]]]+=1
    counter[5]=0  
    if max(counter)==0:
      kon+=' '
    else:   
      kon+='acgt-'[counter.index(max(counter))]
  return kon  


# This function extends signatures in both directions
def RealDataSignatureExtension(Signatures, flankingvarnum,KlassReads,IndexReads):
  siglength=len(Signatures[0])
  ExtSignatures=[]
  ExtReadSeq=[]
  KlassPattern={'Li':"ctct",'Re':"tgtg",'Ze':"aaaa",'DA':"tttt",'AN':"cccc",'NN':"gggg"}  
  for x in range(len(IndexReads)):
    for y in range(len(IndexReads[x])):
      if KlassReads[x][y] in ['No','Ku']: 

        sig=Signatures[IndexReads[x][y]]
        linkssig=''
        rechtssig=''

        for z in range(y+1,len(IndexReads[x])):
          if KlassReads[x][z] in ['No','Ku']:
            rechtssig+=Signatures[IndexReads[x][z]]
          elif KlassReads[x][z] in KlassPattern:
            klasspatt=KlassPattern[KlassReads[x][z]]*siglength
            rechtssig+=klasspatt[:siglength]          
          else:
            rechtssig+=' '*siglength
        rechtssig+=' '*flankingvarnum   

        for z in range(y-1,-1,-1):
          if KlassReads[x][z] in ['No','Ku']:
            linkssig=Signatures[IndexReads[x][z]]+linkssig
          elif KlassReads[x][z] in KlassPattern:
            klasspatt=KlassPattern[KlassReads[x][z]]*siglength
            linkssig=klasspatt[:siglength]+linkssig
          else:
            linkssig=' '*siglength+linkssig
        linkssig=' '*flankingvarnum+linkssig    

        for z in range(flankingvarnum):
          sig=linkssig[len(linkssig)-1-z] + sig + rechtssig[z]  

        ExtSignatures.append(sig) 
        ExtReadSeq.append((x,y))

      if KlassReads[x][y] not in ['No','Ku'] and KlassReads[x][y]!='Cr': 
        sig=(KlassPattern[KlassReads[x][y]]*siglength)[:siglength]
        #sig=Signatures[IndexReads[x][y]]
        linkssig=''
        rechtssig=''

        for z in range(y+1,len(IndexReads[x])):
          if KlassReads[x][z] in ['No','Ku']:
            rechtssig+=Signatures[IndexReads[x][z]]
          elif KlassReads[x][z] in KlassPattern:
            klasspatt=KlassPattern[KlassReads[x][z]]*siglength
            rechtssig+=klasspatt[:siglength]          
          else:
            rechtssig+=' '*siglength
        rechtssig+=' '*flankingvarnum   

        for z in range(y-1,-1,-1):
          if KlassReads[x][z] in ['No','Ku']:
            linkssig=Signatures[IndexReads[x][z]]+linkssig
          elif KlassReads[x][z] in KlassPattern:
            klasspatt=KlassPattern[KlassReads[x][z]]*siglength
            linkssig=klasspatt[:siglength]+linkssig
          else:
            linkssig=' '*siglength+linkssig
        linkssig=' '*flankingvarnum+linkssig    

        for z in range(flankingvarnum):
          sig=linkssig[len(linkssig)-1-z] + sig + rechtssig[z]  

        ExtSignatures.append(sig)  
        ExtReadSeq.append((x,y))

  return ExtSignatures,ExtReadSeq


def NoRealDataSignatureExtension(Signatures, flankingvarnum):
  siglength=len(Signatures[0])
  ExtSignatures=[]
  ExtReadSeq=[]
  KlassPattern={'Li':"ctct",'Re':"tgtg",'Ze':"aaaa",'DA':"tttt",'AN':"cccc",'NN':"gggg"}  
  for x in range(len(IndexReads)):
    for y in range(len(IndexReads[x])):
      if KlassReads[x][y] in ['No','Ku']: 

        sig=Signatures[IndexReads[x][y]]
        linkssig=''
        rechtssig=''

        for z in range(y+1,len(IndexReads[x])):
          if KlassReads[x][z] in ['No','Ku']:
            rechtssig+=Signatures[IndexReads[x][z]]
          elif KlassReads[x][z] in KlassPattern:
            klasspatt=KlassPattern[KlassReads[x][z]]*siglength
            rechtssig+=klasspatt[:siglength]          
          else:
            rechtssig+=' '*siglength
        rechtssig+=' '*flankingvarnum   

        for z in range(y-1,-1,-1):
          if KlassReads[x][z] in ['No','Ku']:
            linkssig=Signatures[IndexReads[x][z]]+linkssig
          elif KlassReads[x][z] in KlassPattern:
            klasspatt=KlassPattern[KlassReads[x][z]]*siglength
            linkssig=klasspatt[:siglength]+linkssig
          else:
            linkssig=' '*siglength+linkssig
        linkssig=' '*flankingvarnum+linkssig    

        for z in range(flankingvarnum):
          sig=linkssig[len(linkssig)-1-z] + sig + rechtssig[z]  

        ExtSignatures.append(sig) 
        ExtReadSeq.append((x,y))

      # if KlassReads[x][y] not in ['No','Ku'] and KlassReads[x][y]!='Cr': 
      #   sig=(KlassPattern[KlassReads[x][y]]*siglength)[:siglength]
      #   #sig=Signatures[IndexReads[x][y]]
      #   linkssig=''
      #   rechtssig=''

      #   for z in range(y+1,len(IndexReads[x])):
      #     if KlassReads[x][z] in ['No','Ku']:
      #       rechtssig+=Signatures[IndexReads[x][z]]
      #     elif KlassReads[x][z] in KlassPattern:
      #       klasspatt=KlassPattern[KlassReads[x][z]]*siglength
      #       rechtssig+=klasspatt[:siglength]          
      #     else:
      #       rechtssig+=' '*siglength
      #   rechtssig+=' '*flankingvarnum   

      #   for z in range(y-1,-1,-1):
      #     if KlassReads[x][z] in ['No','Ku']:
      #       linkssig=Signatures[IndexReads[x][z]]+linkssig
      #     elif KlassReads[x][z] in KlassPattern:
      #       klasspatt=KlassPattern[KlassReads[x][z]]*siglength
      #       linkssig=klasspatt[:siglength]+linkssig
      #     else:
      #       linkssig=' '*siglength+linkssig
      #   linkssig=' '*flankingvarnum+linkssig    

      #   for z in range(flankingvarnum):
      #     sig=linkssig[len(linkssig)-1-z] + sig + rechtssig[z]  

      #   #ExtSignatures.append(sig)  
      #   #ExtReadSeq.append((x,y))

  return ExtSignatures,ExtReadSeq

# This function calculates which Assembly group is closest to the cluster
def AssAct(cluster):
  if len(cluster)==0:
    return ''

  Similarity=[]
  for g in range(len(AlleGruppen)):
    Similarity.append((len([x for x in cluster if x in AlleGruppen[g]]),g))
  Similarity=sorted(Similarity)[::-1]
  string=''
  summe=0
  for (c,g) in Similarity:
    summe+=c
    if c>0:
      string+=str(g)+':'+str(c*100/len(cluster))+'/'
    if summe>0.8*len(cluster) or c<3:
      return string
  return string

def MaxAssAct(cluster):
  if len(cluster)==0:
    return -1
  Similarity=[]
  for g in range(len(AlleGruppen)):
    Similarity.append((len([x for x in cluster if x in AlleGruppen[g]]),g))
  Similarity=sorted(Similarity)[::-1]
  if Similarity[0][0]==0:
    return -1
  return Similarity[0][1]

def MostAssAct(cluster,co):
  if len(cluster)==0:
    return [-1]
  Similarity=[]
  for g in range(len(AlleGruppen)):
    Similarity.append((len([x for x in cluster if x in AlleGruppen[g]]),g))
  Similarity=sorted(Similarity)[::-1]
  #print Similarity
  return [g for (l,g) in Similarity if l>co]

